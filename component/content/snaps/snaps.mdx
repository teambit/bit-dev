import firstSnapHistory from './first-snap-history.png';
import snapOverview from './snap-overview.png';
import { Image } from '@teambit/docs.ui.zoomable-image';

# Snap version

:::note Missing UI Capabilities
Snaps are safe to use, However, Snaps are not represented well in the UI.  
This feature is still under development.
:::

A Snap is an immutable and exportable Component version that is referenced using a hash (`2ec9427...`).
Snaps are used for component collaboration - not for consumption. A snap has no semantic version to communicate how to use it safely. It also has no corresponding published package.

The snap command runs the Component's Build and Snap pipelines before it creates a new version (which also includes the generated data and artifacts). The generated version is stored in the Local Scope, where it can be exported to a Remote Scope.

## Snap a Component

To snap a single component run the following:

```
bit snap COMPONENT_ID [--message SNAP_MESSAGE]
```

For example:

```bash
bit snap company.scope/ui/text --message "a demo snapshot"
```

Once the Snap pipeline is done, the new snap can be seen in the Component's changelog, in the UI:

<Image src={firstSnapHistory} />

To review a Component's changelog in the terminal, use the `bit log` command. For example:

```bash
$ bit log company.scope/ui/text

snap 2ec9427e94b56bd3ed886b7eea42e84563001f5d
author: itaymendel <itay@mydomain.com>
date: 11/14/2021, 12:25:52 PM

      a demo snapshot
```

## Snap a dependent Component

A Component may depend on another Component.
When that happens, the latest snap version of a dependent Component will reference the latest snap version of the Component it depends on.

For example, the following command snaps `company.scope/ui/heading`, which is depends on `company.scope/ui/text`:

```
$ bit snap company.scope/ui/heading

...
1 component(s) snapped
(use "bit export" to push these components to a remote")
(use "bit untag" to unstage versions)

new components
(first version for components)
     > ui/heading@c8aa8acf00c855560443e5be9b8142c70a04c8b8
```

When the latest snap of `company.scope/ui/heading` is examined using `bit show`, it shows the latest snap version of `company.scope/ui/text` (`2ec9427e94b56bd3ed886b7eea42e84563001f5d`) as a dependency.

```
$ bit show company.scope/ui/heading@c8aa8acf00c855560443e5be9b8142c70a04c8b8

┌───────────────────┬──────────────────────────────────────────────────────────────────────────────┐
│ id                │ company.scope/ui/heading@c8aa8acf00c855560443e5be9b8142c70a04c8b8            │
├───────────────────┼──────────────────────────────────────────────────────────────────────────────┤
│ ...               │ ...                                                                          │
├───────────────────┼──────────────────────────────────────────────────────────────────────────────┤
│ dependencies      │ @company/scope.ui.text@2ec9427e94b56bd3ed886b7eea42e84563001f5d- (component) │
│                   │ classnames@2.3.1------------------------------------------------ (package)   │
│                   │ core-js@^3.0.0-------------------------------------------------- (package)   │
├───────────────────┼──────────────────────────────────────────────────────────────────────────────┤
│ ...               │ ...                                                                          │
└───────────────────┴──────────────────────────────────────────────────────────────────────────────┘
```

## Undo a snap

Run the following to undo a Component snap:

```
bit untag COMPONENT_ID SNAP_VERSION
```

:::info
`untag` reverts the latest versioning but does not restore changes to files.
:::

For example, `company.scop/ui/heading` has only one version `c8aa8acf00c855560443e5be9b8142c70a04c8b8` in the Workspace.
This version has not been exported yet, which means it can be undone:

```
bit untag company.scop/ui/heading c8aa8acf00c855560443e5be9b8142c70a04c8b8
```

Since `company.scop/ui/heading` has only one version, undoing that versioning restores its status to `new`. This can be validated by running `bit status`:
```
$ bit status

new components
(use "bit tag --all [version]" to lock a version with all your changes)

     > ui/heading ... ok
                         

snapped components
(use "bit tag --all [version]" or "bit tag --snapped [version]" to lock a version)

     > ui/text ... ok
                         
...
```

## Snapshot all modified Components

Use the `--all` flags to snap all modified Components in the Workspace. Dependent Components will reference, in their dependency graph, the new snap versions of their dependencies.

```bash
bit snap --all --message "update several components"
```

A versioned Component (either snapped or tagged) can be versioned again only if it has been modified since its last version.

A Component is considered modified if one or more of the following is true:

- One of its source files has been changed
- A file has been added to it, or removed
- Its dependency graph has been changed
- Its Component configuration has been changed

### Auto-snap dependents

Use the `--auto-snap-dependents` option to snap a Component, as well as every direct and indirect dependent Component of it.

```bash
bit snap ui/heading --message "update my heading" --auto-snap-dependents
```
