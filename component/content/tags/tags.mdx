import firstTag from './first-tag.png';
import { Image } from '@teambit/docs.ui.zoomable-image';

# Versioning components

You can tag a specific state of a component as being a release. Bit calls these annotations **Tags**, and use semantic versioning for marking these releases. A tag is immutable, making it safe for consumers to depend on.  
There are additional attributes that make Tags work best for consumers, we'll go over them in this section.

To showcase how tagging work, create a new workspace and add your first component.  
For this demo we'll use a basic demo project, as it has a few components to start with.

```bash
bit new react tag-demo --include-components
cd tag-demo
```

All components in this project are new, so none of them has any versions.  
To record our first version we use the `tag` command:

```bash
bit tag ui/text --ver 1.0.0 --message "my first version"
```

During the `snap` process, Bit runs the full component [build pipeline](/dev-services/builder/build-pipelines#build-pipelines), as defined in its environment.  
We can see the new version in the component's **changelog** tab in the workspace-ui:

<Image src={firstTag} />

```bash
$ bit log ui/heading

tag 1.0.0 (e0121fa8db05451c170b7204c95d14215c8b76b5)
author: Jane <jane@my-company.dev>
date: 10/27/2021, 5:41:00 AM

      my first version
```

Now that you have a new version, you can also run `status` to see that the component is tagged:

```bash
bit status
```

```bash
new components
(use "bit tag --all [version]" to lock a version with all your changes)

     > pages/welcome ... ok
     > ui/card ... ok
     > ui/heading ... ok
                         
staged components
(use "bit export <remote_scope> to push these components to a remote scope")

     > ui/text. versions: 1.0.0 ... ok
```

## Semantic versioning

Bit adheres to Semantic Versioning as defined by [SemVer](https://semver.org/) when versioning components. This way any package manager like npm, yarn or pnpm can consume the component as a dependency to a project.  
The `tag` command has several features you can use for versioning:

```bash
bit tag --all --major --message "my version message"  # Version all modified and new components with a major version.
bit tag --all --minor --message "my version message"  # Version all modified and new components with a minor version.
bit tag "ui/*" --patch --message "my version message" # Version components matching the pattern with a patch version.
bit tag ui/text --message "my version message"        # Version a specific component with default increment (patch).
```

## Undoing a tag

We can untag staged components, i.e., components that were tagged by not yet exported to a remote scope.  
Bit untag reverts the component to its previous state, i.e., `new`, `modified` or `exported`.

```bash
bit untag ui/text # Use bit untag to untag a component
bit untag ui/heading 1.0.0 # untag specific local version
bit untag --all 0.11.4 # untag a version from all components
bit untag --all # untag all versions from all components
```

Untag does not revert code changes made in the component.

## Exporting tags

To allow consumers to use a version of a component we first must tag is with a version. They we can export tag using `export` command:

```bash
bit export
```

:::note When self-hosting bit

If you are self-hosting Bit, the process of publishing a component to a registry happens as part of the `bit tag` process, not `bit export`.  
When using bit.cloud, consumption happens directly from a remote Scope, so `tag` does not need to publish to a registry.

:::

## Tagging new versions

As components are not only built from source code, there are various things that Bit considers as "changes" for a component:

- Modification in any of the component files.
- New file added.
- File removed.
- Dependency version update.
- Configuration changed.

Change any of the files in `demo/ui/text`, and then run `tag` again:

```bash
bit tag ui/text --message "my version message"
```

When we run `bit log` for `ui/text` again, we see the updated revision history:

```bash
tag 1.0.1 (e0121fa8db05451c170b7204c95d14215c8b76b5)
author: Jane <jane@my-company.dev>
date: 10/27/2021, 6:41:00 AM

      my version message

tag 1.0.0 (e0121fa8db05451c170b7204c95d14215c8b76b5)
author: Jane <jane@my-company.dev>
date: 10/27/2021, 5:41:00 AM

      my first version
```

### Explore the version history

Bit keeps a visual representation of the version history of a component. Run either the local dev-server:

```bash
bit start
```

In each component's **changelog** tag you can see all past versions and choose to explore each of them.

## Automated dependent versioning

When a component is tagged, Bit automatically version all the components that depend on it. Auto-tag has two basic rules:

- Components are always auto tagged with a patch version, regardless of the bump type applied on the dependency.
- Tagging is propagated to the dependency chain of the component.

### Skip auto-tag

You may skip the auto-tag behavior for a component by using the `--skip-auto-tag` flag:

```bash
bit tag ui/heading --message "my version message" --skip-auto-tag
```
